workflows:
  default-workflow:
    name: Default Workflow
    instance_type: linux_x2
    max_build_duration: 60
    environment:
      vars:
        FCI_KEYSTORE_PATH: /tmp/keystore.keystore
        FCI_KEYSTORE: Encrypted(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)
        FCI_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmc1MjZNNG5PMkQxdUFZbjB0bmVzT2lzaFZ0aGhyOWxDVEZJeWloT3VNN21LaHVnenFQeDVsMmdTcXJSZFpJWUZwWVVDci1acXQwcUJEbkN0M1RpX1U2U05FdkE9PQ==)
        FCI_KEY_ALIAS: Encrypted(Z0FBQUFBQmc1MjZsbFJVemw2QUpZRl9UNWx1MGR2TjlSQ2hxMjR1ZWdmVlBTME1fS2Q0cGVsOFBkUnE4R3JyR2E2dlZQU29SYmJTbTNRWEZDYUM2VXZPVjBmV0hlTUxhR0E9PQ==)
#         GOOGLE_PLAY_TRACK: "internal"
#         GCLOUD_SERVICE_ACCOUNT_CREDENTIALS: Encrypted(ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAicGMtYXBpLTY2OTc2NDE2OTI0NDMxNTUwNTItNjUwIiwKICAicHJpdmF0ZV9rZXlfaWQiOiAiOTRkOTQ1NWJiNTg4OWM1NGE3ZjRmNmVjN2EwYWFiMDYzYzYxZGFlMCIsCiAgInByaXZhdGVfa2V5IjogIi0tLS0tQkVHSU4gUFJJVkFURSBLRVktLS0tLVxuTUlJRXZBSUJBREFOQmdrcWhraUc5dzBCQVFFRkFBU0NCS1l3Z2dTaUFnRUFBb0lCQVFDajJTRzd3clBmdUx3clxubW9ScTFURURoS01vd1N4UlFGRGExTFp0b3hVZGduWURZbkRYb1Y5TGhGSFd6UFVmUGZrc0tTNU5uN2YxanZDNVxua2FHMUtBbnl1Tm1qUzQwdjBaai9JVFF5WVVYY1NGeHFSblkyNVJVdGhFa3ZsaU1JUDhwY052ZXJHekhXNnloa1xudjJLa3hKblo5NFdOcFhnbDBWNkF4b0Q1N04ydmgrYWRKdVNOVUkwMGNaTW1yM3EzcEoybjYrbnN5VmRnWDFhTVxuSlJsdG5WTkFaSlZnOTVkdHZyVS91M2ZGR1N0RFhRWlVDdW5YSVJKL2xhSEVtaFM3MDZtaHB6enE1ZUdFMG5mWVxuUGFvL3NYRmpzNGxsQitPc2pMV3BGM1VuVDdrRVc4UzZQSUVGdVpyRG5WRk56aGdoYWh5MnVMbURXejlpejBxN1xubXpGa3BxZmxBZ01CQUFFQ2dnRUFCd0hnRzUvRWwwS3NmWVdTdUlwSFJJVEFLNXZlQnRnNWZRVVFOa1BTd1RFcVxucXo0TnRiM000d3NVMVpzWFlxVFdZQlAweXlvVHNTMzhwVVc4Qk9ZM29yTlN6My9lMlJiZGlicHUrVGFkYzhIVFxuMDFHOGVEV002eVpDQmxzbFFyMk9WeXBIVVFDTlBaNmtzQnV2OUNjRkEyN3BhSGpxcmdkZkdNMGtoL1oxakFPeVxuSkRucWRiWWl2Ym5NK1VZQTRVRzdmVWV0akx2V040dWcvbWk0U3hweHJWVy95NHV4Y29uN1ZIUnhTa09IVjBMK1xuYjBRV3dqWkdEam0yZWRWUXNCUms2akJGcTVXUEcyb29aRGRWb2t1a25QaTNpQ0NUM2orUUsxRFR0bXVMaWFRK1xuVVlGL25vTjVJWm1aVzFiL0c5UHo4NW5xTEJKckkrd1pqdGQyNFFGMUFRS0JnUURoS25OaHN2NW01ZG45amxwSFxua1Z2ZTJCc3FCclVoQ0dSbGgvYkx4aGF5Q3FrNEgzVEU2ZXMzTEJPUjRMU09FTTBEcm9Vb05ScW1rY0gvUVZ5aVxuRm9kQlE3bHNlVlBpUzkxUjBXcUNlWW9LSVNnTmFFbFlUNGxHOHlSaFFaNmJPTFZ6TTJSQ0ozRkIwRU5JQU9UR1xuc21ZTnlRaitxODE0VW1rTG52eWhoTVdXWlFLQmdRQzZTUmVrN0w4eHNPVjl1QmJsQUwvK0h5KzlVYWNoaDZCSlxuYVRtTXRTeVhvOGlRMFpSajB5U1F0eE8yazQvV1FZNkg4WE44cFluZ0k1MUpZU3p0NWZFV1Z1alJvUCtkQWhJaVxua1VFckVNUDJQSGluVDJEWllWdXZtZFZrRVZ1Q0FURlNEVTdwQnNRN1VnKzlBb2dRcFkyWnFjS0JRWHJ4WmM2bFxuUXVycUFzVHpnUUtCZ0R2ZndPekMzeGxYbDU3d0FwdXpVSDJ5YzQ2NlYrSGZ6R3FmUEFZMXQ0VkNobnJ4Q21qdVxuVnVqRjVMSk8wVlJScldLRVBzNVJTTFB3WUdqUzVhSUlZWkQrUkVsTy9mcFgrQk13bjZUd1VyK2N6M3k1TlgreFxuTHF6YUxOdGJ5cVExOFRJZ0FWSUNFUURTTTRIckV1cXZONm9Fd2txT1BzWDNEQTNXQ2hHZEw3bHRBb0dBY3gzR1xuQ2JudmNOS2pEcXliSVVyMFdpS0ZpdFdSbFd2TmhuQUxDMFBPV2FyeHYyUno4YmhCNlZmcFM3TW1lTDJzU1ovUVxud1I4Kzg0NnVuUEQ3SmN3cHpxZElXbnJHV3cwempiNzdhWlNEdEgrc0E2Qk85aVp1MVRZWUl5MkN3ZlRndUpiV1xudzdQVndkNjFNUlVHWmxzWUJQUmQ2U2hBeERvb21BR2hUNWtFZ29FQ2dZQnRnWjFjUVNSSlBXTnMzMzVuc1BMOFxuYlVMd2VYQkNYK0huYm9raXlVc013c0N1VmErWkNYRUVtZzIvR3RVMXhtUG8ybENzUjg0dlp5cE83V0xCM1ZWMlxubWIwNTRzMXlPRGg1MVBySkhiY3FIVkJFcUZ1S05rNXE2V3VwSlQ0VnVsckU1K1pab2lSUHNNclh1NVFpeXYrRFxuVEh0aXVYZWVzUVlqL05COXBzRHorZz09XG4tLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tXG4iLAogICJjbGllbnRfZW1haWwiOiAieWFtbC10ZXN0LWFwcEBwYy1hcGktNjY5NzY0MTY5MjQ0MzE1NTA1Mi02NTAuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLAogICJjbGllbnRfaWQiOiAiMTA5NTkzMTA3NTc0ODMwOTkzODMxIiwKICAiYXV0aF91cmkiOiAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGgiLAogICJ0b2tlbl91cmkiOiAiaHR0cHM6Ly9vYXV0aDIuZ29vZ2xlYXBpcy5jb20vdG9rZW4iLAogICJhdXRoX3Byb3ZpZGVyX3g1MDlfY2VydF91cmwiOiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vb2F1dGgyL3YxL2NlcnRzIiwKICAiY2xpZW50X3g1MDlfY2VydF91cmwiOiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vcm9ib3QvdjEvbWV0YWRhdGEveDUwOS95YW1sLXRlc3QtYXBwJTQwcGMtYXBpLTY2OTc2NDE2OTI0NDMxNTUwNTItNjUwLmlhbS5nc2VydmljZWFjY291bnQuY29tIgp9Cg==)
        FCI_KEY_PASSWORD: Encrypted(Z0FBQUFBQmc1MjZNNG5PMkQxdUFZbjB0bmVzT2lzaFZ0aGhyOWxDVEZJeWloT3VNN21LaHVnenFQeDVsMmdTcXJSZFpJWUZwWVVDci1acXQwcUJEbkN0M1RpX1U2U05FdkE9PQ)     
      flutter: stable
      xcode: latest
      cocoapods: default
    triggering:
      events:
        - push
      branch_patterns:
        - pattern: '*'
          include: true
          source: true
    scripts:         
      - |
          # set up key.properties
          echo $FCI_KEYSTORE | base64 --decode > $FCI_KEYSTORE_PATH
          cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
          storePassword=$FCI_KEYSTORE_PASSWORD
          keyPassword=$FCI_KEY_PASSWORD
          keyAlias=$FCI_KEY_ALIAS
          storeFile=/tmp/keystore.keystore
          EOF
      - |
        # set up local properties
        echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - flutter packages pub get
      - flutter build apk --release --build-name=2.0.$BUILD_NUMBER --build-number=$(($BUILD_NUMBER+ 1))
    artifacts:
      - build/**/outputs/**/*.apk
      - build/**/outputs/**/*.aab
      - build/**/outputs/**/mapping.txt
      - flutter_drive.log
    publishing:
      email:
        recipients:
          - nihal@nevercode.io
#       google_play: 
#         credentials: $GCLOUD_SERVICE_ACCOUNT_CREDENTIALS
#         track: $GOOGLE_PLAY_TRACK
